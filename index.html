<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíïCerita Kita üíï</title>
    <style>
        /* CSS TETAP SAMA SESUAI PERMINTAAN */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            overflow-x: hidden;
            color: #333;
        }

        /* ===== MIDNIGHT GARDEN STYLES ===== */
        .midnight-garden {
            position: absolute;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
            z-index: 0;
        }

        .garden-star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--t) infinite ease-in-out;
            z-index: 0;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.1; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }

        .garden-bokeh {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            filter: blur(4px);
            animation: floatUp var(--d) linear infinite;
            z-index: 1;
        }
        @keyframes floatUp {
            0% { transform: translateY(110vh) scale(0.5); opacity: 0; }
            50% { opacity: 0.4; }
            100% { transform: translateY(-20vh) scale(1.5); opacity: 0; }
        }

        .garden-glow {
            position: absolute;
            bottom: 0; width: 100%; height: 60%;
            background: radial-gradient(ellipse at bottom, rgba(102, 126, 234, 0.15) 0%, transparent 80%);
            z-index: 1;
        }

        .garden-blade {
            position: absolute;
            bottom: -5px;
            width: 2px;
            background: linear-gradient(to top, rgba(255,255,255,0.05), rgba(255,255,255,0.15));
            border-radius: 100% 100% 0 0;
            transform-origin: bottom center;
            z-index: 2;
        }

        .garden-flower-system {
            position: absolute;
            bottom: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 3;
        }

        .garden-stem {
            width: 4px;
            background: linear-gradient(to top, rgba(255,255,255,0.1), rgba(255,255,255,0.2));
            border-radius: 4px;
            height: 0;
            position: relative;
            animation: growStem 2.5s ease-out forwards;
        }
        @keyframes growStem { to { height: var(--h); } }

        .garden-leaf {
            position: absolute;
            width: 45px;
            height: 20px;
            background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.15));
            border-radius: 2px 40px 5px 40px;
            opacity: 0;
            transform-origin: 0% 50%;
            box-shadow: inset 2px -2px 8px rgba(0,0,0,0.2);
            animation: leafIn 1.5s ease-out forwards;
            left: 50%;
        }

        .garden-leaf.l { transform: scaleX(-1) rotate(15deg); margin-left: -2px; }
        .garden-leaf.r { transform: rotate(15deg); margin-left: 2px; }

        @keyframes leafIn {
            0% { opacity: 0; transform: scale(0) rotate(45deg); }
            100% { opacity: 0.7; }
        }

        .garden-flower-head {
            position: absolute;
            top: 0;
            transform: translateY(-50%) scale(0);
            display: flex;
            justify-content: center;
            align-items: center;
            animation: bloom 1.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }
        @keyframes bloom { to { transform: translateY(-50%) scale(1); } }

        .garden-petal {
            position: absolute;
            bottom: 0;
            width: var(--pw);
            height: var(--ph);
            background: linear-gradient(to top, var(--c), rgba(255,255,255,0.8));
            border-radius: 50% 50% 20% 20% / 80% 80% 20% 20%;
            transform-origin: bottom center;
            filter: drop-shadow(0 0 10px var(--c));
            opacity: 0.7;
        }

        .garden-center {
            position: absolute;
            width: 12px; height: 12px;
            background: radial-gradient(circle, #fff, rgba(241, 196, 15, 0.8));
            border-radius: 50%;
            z-index: 20;
            filter: blur(1px) drop-shadow(0 0 8px rgba(255, 215, 0, 0.6));
        }

        .garden-sway {
            animation: swayAnim 7s infinite ease-in-out;
            transform-origin: bottom center;
        }
        @keyframes swayAnim {
            0%, 100% { transform: rotate(-1.5deg) translateX(0); }
            50% { transform: rotate(1.5deg) translateX(3px); }
        }

        .page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }

        .hidden { display: none; }

        /* ===== HOME PAGE ===== */
        #home::before {
            content: '';
            position: absolute;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            top: -200px;
            right: -200px;
            animation: float 20s infinite ease-in-out;
            z-index: 0;
        }

        #home::after {
            content: '';
            position: absolute;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
            bottom: -150px;
            left: -150px;
            animation: float 15s infinite ease-in-out reverse;
            z-index: 0;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(50px, 50px) scale(1.1); }
        }

        .home-content {
            text-align: center;
            z-index: 10;
            max-width: 600px;
            position: relative;
        }

        .home-title {
            font-size: 4em;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 10px 30px rgba(0,0,0,0.3);
            letter-spacing: 2px;
            animation: slideDown 1s ease-out;
        }

        .home-subtitle {
            font-size: 1.5em;
            color: rgba(255,255,255,0.95);
            margin-bottom: 50px;
            font-weight: 300;
            animation: slideUp 1s ease-out 0.3s both;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .start-btn {
            padding: 20px 60px;
            font-size: 1.3em;
            font-weight: 600;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: slideUp 1s ease-out 0.6s both;
        }

        .start-btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 20px 45px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
        }

        /* Hearts Animation */
        .hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }

        .heart {
            position: absolute;
            font-size: 2em;
            color: rgba(255, 255, 255, 0.6);
            animation: rise 12s infinite ease-in;
        }

        @keyframes rise {
            0% { transform: translateY(100vh) scale(0) rotate(0deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-100vh) scale(1.5) rotate(360deg); opacity: 0; }
        }

        .heart:nth-child(1) { left: 10%; animation-delay: 0s; animation-duration: 10s; }
        .heart:nth-child(2) { left: 20%; animation-delay: 2s; animation-duration: 12s; }
        .heart:nth-child(3) { left: 30%; animation-delay: 4s; animation-duration: 14s; }
        .heart:nth-child(4) { left: 40%; animation-delay: 1s; animation-duration: 11s; }
        .heart:nth-child(5) { left: 50%; animation-delay: 3s; animation-duration: 13s; }
        .heart:nth-child(6) { left: 60%; animation-delay: 5s; animation-duration: 15s; }
        .heart:nth-child(7) { left: 70%; animation-delay: 2.5s; animation-duration: 12s; }
        .heart:nth-child(8) { left: 80%; animation-delay: 4.5s; animation-duration: 14s; }
        .heart:nth-child(9) { left: 90%; animation-delay: 1.5s; animation-duration: 11s; }
        .heart:nth-child(10) { left: 15%; animation-delay: 6s; animation-duration: 13s; }

        /* ===== BACK BUTTON ===== */
        .back-btn {
            position: fixed;
            top: 30px;
            left: 30px;
            padding: 12px 30px;
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            color: #667eea;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .back-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            background: white;
        }

        /* ===== GALLERY PAGE ===== */
        .gallery-header {
            text-align: center;
            margin-bottom: 30px;
            z-index: 10;
            color: white;
            position: relative;
        }

        .gallery-title {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .gallery-desc { font-size: 1.2em; opacity: 0.95; }

        .gallery-container {
            display: flex;
            gap: 30px;
            padding: 20px;
            overflow-x: auto;
            width: 100%;
            max-width: 100vw;
            scrollbar-width: thin;
            scrollbar-color: rgba(255,255,255,0.5) transparent;
            position: relative;
            z-index: 10;
        }

        .gallery-container::-webkit-scrollbar { height: 10px; }
        .gallery-container::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 10px; }
        .gallery-container::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.5); border-radius: 10px; }

        .polaroid {
            background: white;
            padding: 20px;
            min-width: 280px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            transform: rotate(-2deg);
            transition: all 0.4s ease;
            position: relative;
            border-radius: 15px;
            flex-shrink: 0;
            cursor: pointer;
        }

        .polaroid:nth-child(even) { transform: rotate(2deg); }
        .polaroid:hover {
            transform: rotate(0deg) scale(1.08);
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            z-index: 10;
        }

        .photo-wrapper {
            width: 100%;
            height: 280px;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            border-radius: 10px;
            margin-bottom: 15px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .photo-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .polaroid:hover .photo-wrapper img { transform: scale(1.1); }
        .photo-caption { text-align: center; font-weight: 600; color: #667eea; font-size: 1.1em; margin-bottom: 5px; }
        .photo-message { text-align: center; font-style: italic; color: #666; font-size: 0.95em; }

        .secret-message {
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.98);
            display: none;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            font-weight: bold;
            color: #667eea;
            border-radius: 15px;
            font-size: 1.3em;
        }

        .polaroid.show .secret-message { display: flex; }

        .gallery-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            z-index: 10;
            position: relative;
        }

        .nav-btn {
            padding: 12px 30px;
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .nav-btn:hover {
            background: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* Floating Emojis di Galeri */
        .floating-emojis {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 5;
        }

        .emoji {
            position: absolute;
            font-size: 2em;
            animation: floatEmoji 8s ease-in-out infinite;
            opacity: 0.7;
        }

        @keyframes floatEmoji {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(15deg); }
        }

        .emoji:nth-child(1) { top: 15%; left: 5%; animation-delay: 0s; }
        .emoji:nth-child(2) { top: 25%; right: 8%; animation-delay: 1.5s; }
        .emoji:nth-child(3) { top: 40%; left: 10%; animation-delay: 3s; }
        .emoji:nth-child(4) { top: 55%; right: 12%; animation-delay: 4.5s; }
        .emoji:nth-child(5) { top: 70%; left: 7%; animation-delay: 6s; }
        .emoji:nth-child(6) { top: 35%; right: 5%; animation-delay: 2s; }
        .emoji:nth-child(7) { top: 60%; left: 15%; animation-delay: 5s; }
        .emoji:nth-child(8) { top: 80%; right: 10%; animation-delay: 7s; }

        /* ===== PUZZLE PAGE ===== */
        .puzzle-header {
            text-align: center;
            margin-bottom: 20px;
            color: white;
            position: relative;
            z-index: 10;
        }

        .puzzle-title {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .puzzle-subtitle { font-size: 1.2em; opacity: 0.95; padding: 0 10px; }

        #game {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            margin-bottom: 30px;
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 1000px;
        }

        #board {
            width: 360px;
            height: 450px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .cell {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            transition: all 0.3s ease;
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .cell:hover { background: rgba(255, 255, 255, 0.2); border-color: #fff; }

        .cell.filled {
            background-image: var(--img);
            background-size: 300% 300%;
            background-repeat: no-repeat;
            border: none;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
        }

        #pieces {
            width: 360px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            max-height: 450px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .piece {
            width: 90px;
            height: 112px;
            border: 2px solid #fff;
            border-radius: 10px;
            cursor: grab;
            background-image: var(--img);
            background-size: 300% 300%;
            background-repeat: no-repeat;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .piece:active { cursor: grabbing; transform: scale(1.1); z-index: 100; }

        .new-game-btn {
            padding: 15px 45px;
            background: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 600;
            color: #16213e;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
        }

        /* ===== WIN POPUP ===== */
        #winPopup {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        #winBox {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 30px 80px rgba(0,0,0,0.5);
            animation: popUp 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            color: #16213e;
            width: 85%;
            max-width: 400px;
        }

        #winBox h2 { font-size: 2.5em; margin-bottom: 10px; }
        #winBox p { margin-bottom: 25px; }

        .popup-btn {
            padding: 12px 40px;
            background: #16213e;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
        }

        /* ===== LOVE LETTER PAGE ===== */
        .letter-container {
            max-width: 550px;
            width: 92%;
            background: #fffdf9;
            padding: 40px 25px;
            border-radius: 5px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            color: #444;
            text-align: center;
            animation: slideDown 0.8s ease-out;
            position: relative;
            z-index: 10;
            border: 1px solid #e0dcd0;
            background-image: radial-gradient(#d1d1d1 0.5px, transparent 0.5px);
            background-size: 20px 20px;
        }

        .letter-container::before {
            content: '';
            position: absolute;
            inset: 10px;
            border: 1px solid #d4af37;
            pointer-events: none;
            opacity: 0.5;
        }

        .letter-header { margin-bottom: 25px; position: relative; }
        .letter-title { font-size: 2.2em; color: #d63384; margin-bottom: 5px; font-weight: 700; font-family: 'Georgia', serif; }
        .letter-date { font-size: 0.9em; color: #888; font-style: italic; letter-spacing: 1px; }

        .letter-body {
            text-align: left;
            line-height: 1.8;
            margin-bottom: 30px;
            max-height: 50vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .letter-body::-webkit-scrollbar { width: 4px; }
        .letter-body::-webkit-scrollbar-thumb { background: #d63384; border-radius: 10px; }
        .letter-body p { margin-bottom: 15px; font-size: 1.05em; color: #333; font-family: 'Georgia', serif; }

        .letter-signature {
            text-align: right;
            font-size: 1.2em;
            color: #d63384;
            font-weight: 600;
            margin-top: 20px;
            font-style: italic;
            font-family: 'Georgia', serif;
        }

        .letter-btn {
            padding: 14px 40px;
            background: #d63384;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            color: white;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(214,51,132,0.3);
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .letter-btn:hover { transform: translateY(-3px); background: #c2126d; }

        .letter-hearts { position: absolute; font-size: 1.5em; opacity: 0.15; color: #d63384; }
        .letter-hearts:nth-child(1) { top: 20px; left: 20px; }
        .letter-hearts:nth-child(2) { top: 20px; right: 20px; }
        .letter-hearts:nth-child(3) { bottom: 20px; left: 20px; }
        .letter-hearts:nth-child(4) { bottom: 20px; right: 20px; }

        /* Responsive */
        @media (max-width: 768px) {
            .page { padding: 20px 10px; }
            .home-title { font-size: 2.5em; }
            .gallery-title, .puzzle-title { font-size: 2.2em; }
            #board { width: 90vw; height: 112.5vw; max-width: 320px; max-height: 400px; padding: 8px; gap: 5px; }
            #pieces { width: 90vw; max-width: 320px; padding: 15px; gap: 8px; }
            .piece { width: 75px; height: 94px; }
            .new-game-btn { padding: 12px 35px; font-size: 1em; }
            .letter-title { font-size: 1.8em; }
        }

        @media (max-width: 480px) {
            .home-title { font-size: 2.2em; }
            .puzzle-title { font-size: 1.8em; }
            .piece { width: 65px; height: 81px; }
        }
    </style>
</head>

<body>
    <!-- AUDIO ELEMENTS -->
    <audio id="audioHome" src="lagu_home.mp3" loop></audio>
    <audio id="audioGallery" src="lagu_galeri.mp3" loop></audio>
    <audio id="audioLetter" src="lagu_surat.mp3" loop></audio>
    <audio id="audioPuzzle" src="lagu_puzzle.mp3" loop></audio>

    <!-- HOME PAGE -->
    <div id="home" class="page">
        <div class="midnight-garden"></div>
        <div class="hearts">
            <div class="heart">üíï</div><div class="heart">üíñ</div>
            <div class="heart">üíó</div><div class="heart">üíù</div>
            <div class="heart">üíï</div><div class="heart">üíñ</div>
            <div class="heart">üíó</div><div class="heart">üíù</div>
            <div class="heart">üíï</div><div class="heart">üíñ</div>
        </div>
        <div class="home-content">
            <h1 class="home-title">üíï Cerita Kita üíï</h1>
            <p class="home-subtitle">Hai dila ini Perjalanan Cinta Kita.</p>
            <button class="start-btn" onclick="goToGallery()">Yuu mulai Petualangan</button>
        </div>
    </div>

    <!-- GALLERY PAGE -->
    <div id="gallery" class="page hidden">
        <div class="midnight-garden"></div>
        <button class="back-btn" onclick="goToHome()">‚Üê Kembali</button>
        <div class="floating-emojis">
            <div class="emoji">üòç</div><div class="emoji">üíñ</div>
            <div class="emoji">ü•∞</div><div class="emoji">üòò</div>
            <div class="emoji">üå∏</div><div class="emoji">üíï</div>
            <div class="emoji">üåü</div><div class="emoji">‚ú®</div>
        </div>
        <div class="gallery-header">
            <h2 class="gallery-title">üì∏ Galeri Kenangan üì∏</h2>
            <p class="gallery-desc">Ini Foto-Foto kita Dari Awal Hingga sekarangüíï</p>
            <p class="gallery-desc">Di Geser ke kanan yaa</p>
        </div>
        <div class="gallery-nav">
            <button class="nav-btn" onclick="goToLetter()">üíå Baca Surat Cinta üíå</button>
        </div>
        <div class="gallery-container" id="galleryContainer"></div>
    </div>

    <!-- LOVE LETTER PAGE -->
    <div id="letter" class="page hidden">
        <div class="midnight-garden"></div>
        <button class="back-btn" onclick="goToGallery()">‚Üê Ke Galeri</button>
        <div class="letter-container">
            <span class="letter-hearts">üíï</span><span class="letter-hearts">üíñ</span>
            <span class="letter-hearts">üíó</span><span class="letter-hearts">üíù</span>
            <div class="letter-header">
                <h2 class="letter-title">Untuk Dila üíï</h2>
                <p class="letter-date">Teruntuk kamu yang selalu di hati</p>
            </div>
            <div class="letter-body">
                <p>Hai Dila.</p>
                <p>Adi nggak pernah nyangka kita bisa sejauh ini. Sejak ada Dila, hal-hal kecil yang dulu biasa aja sekarang jadi punya arti. Makasih ya, sudah selalu ada buat Adi, sudah nerima Adi dengan segala baik dan buruknya. Maaf juga untuk semua kebiasaan buruk Adi yang kadang bikin kamu capek.</p>
                <p>Dari setiap tawa, senyum, sampai air mata yang kita bagi, semuanya jadi bagian dari cerita kita yang indah. Kamu bukan cuma orang yang Adi cintai, tapi kamu adalah rumah.</p>
                <p>Terima kasih sudah jadi bagian dalam hidup Adi. Terima kasih untuk setiap detik yang kita lewati bersama. Adi janji akan selalu ada buat kamu, di saat senang maupun saat dunia terasa berat.</p>
                <p>Adi berharap kita bisa terus saling jaga, saling genggam, dan saling Mencintai.</p>
            </div>
            <div class="letter-signature">Dengan cinta,<br>Untuk selamanya üíï</div>
            <button class="letter-btn" onclick="goToPuzzle()">Lanjut ke Puzzle üß©</button>
        </div>
    </div>

    <!-- PUZZLE PAGE -->
    <div id="puzzle" class="page hidden">
        <div class="midnight-garden"></div>
        <button class="back-btn" onclick="goToGallery()">‚Üê Ke Galeri</button>
        <div class="puzzle-header">
            <h1 class="puzzle-title">üß© Photo Puzzle üß©</h1>
            <p class="puzzle-subtitle">Susun puzzle untuk melihat foto kita</p>
            <p class="puzzle-subtitle">Jangan sampe salah ya üò§</p>
        </div>
        <div id="game">
            <div id="board"></div>
            <div id="pieces"></div>
        </div>
        <button class="new-game-btn" onclick="initPuzzle()">üîÑ Puzzle Baru</button>
    </div>

    <!-- WIN POPUP -->
    <div id="winPopup">
        <div id="winBox">
            <h1>üéâ Yeee Berhasil üéâ</h1>
            <p>Kamu berhasil menyelesaikan puzzle jadi makin cantik deh</p>
            <button class="popup-btn" onclick="closePopup()">Main Lagi</button>
        </div>
    </div>

    <script>
        // Caching DOM Elements
        const DOM = {
            pages: document.querySelectorAll('.page'),
            galleryContainer: document.getElementById('galleryContainer'),
            board: document.getElementById('board'),
            pieces: document.getElementById('pieces'),
            winPopup: document.getElementById('winPopup'),
            audios: {
                home: document.getElementById('audioHome'),
                gallery: document.getElementById('audioGallery'),
                letter: document.getElementById('audioLetter'),
                puzzle: document.getElementById('audioPuzzle')
            }
        };

        // Data
        const TANGGAL = [
            "14 Agu 2024", "15 Sep 2024", "15 Sep 2024", "03 Okt 2024", "13 Okt 2024", "19 Okt 2024", "27 Okt 2024", 
            "09 Nov 2024", "23 Nov 2024", "08 Des 2024", "25 Des 2024", "19 Jan 2025", "19 Mar 2025", "19 Mar 2025", 
            "31 Mar 2025", "26 Apr 2025", "23 Mei 2025", "23 Mei 2025", "09 Jun 2025", "06 Agu 2025", "09 Nov 2025", 
            "09 Nov 2025", "09 Nov 2025", "19 Nov 2025", "19 Nov 2025","24 Feb 2025", "01 Jan 2026"
        ];

        const PHOTO_MESSAGES = [
            'Foto pertama üíï', 'Hari spesial ‚ú®', 'Senyummin dulu üòä', 'Mirror Selfie üå∏', 'Dia bm dimsum ü•¢‚ú®', 
            'Nonton hindia üé∏', 'pulangnya ngambek üòí ', 'Sebel rambut pendeküò§', 'Mirror Selfie lagi üíñ', 
            'Nonton bioskopüé¨', 'Melet dikit üòú', 'Knya gak cintaüëçü§ç', 'Di kasi kue üéÇ', 'kado dari dilaa üéÅ', 
            'pose muka jelek ü§™', 'hemmm üòë', 'Nonton konser üé∂', 'Cape nonton üôå', 'Rakit lego üß© ',
            'jalan jalan üõµüõ£Ô∏è', 'Adi ngasih bunga üå∏', 'bunganya kalah cantik üå∑', 'üå∫üíê ', 'Foto box üë´', 
            'cosply jadi koboy ü§†', 'Abis nonton avatar ü•∞', 'selamanya üíï'
        ];

        const PUZZLE_PHOTOS = ["fotopzl1.jpg", "fotopzl2.jpg", "fotopzl3.jpg"];
        const ROWS = 3, COLS = 3;
        let boardState = [];
        let photoIndex = 0;

        // Music Logic
        function playMusic(pageName) {
            Object.values(DOM.audios).forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });
            const selected = DOM.audios[pageName];
            if (selected) {
                selected.play().catch(() => console.log("User interaction required"));
            }
        }

        // Navigation
        function showPage(id) {
            DOM.pages.forEach(p => p.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function goToHome() { showPage('home'); playMusic('home'); }
        function goToGallery() { showPage('gallery'); initGallery(); playMusic('gallery'); }
        function goToLetter() { showPage('letter'); playMusic('letter'); }
        function goToPuzzle() { showPage('puzzle'); initPuzzle(); playMusic('puzzle'); }

        // Gallery logic
        function initGallery() {
            if (DOM.galleryContainer.children.length > 0) return;
            const fragment = document.createDocumentFragment();
            for (let i = 1; i <= 27; i++) {
                const polaroid = document.createElement('div');
                polaroid.className = 'polaroid';
                polaroid.innerHTML = `
                    <div class="photo-wrapper">
                        <img src="foto${i}.jpg" alt="Foto ${i}" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22280%22 height=%22280%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22280%22 height=%22280%22/%3E%3C/svg%3E'">
                    </div>
                    <p class="photo-caption">${TANGGAL[i - 1] || ""}</p>
                    <p class="photo-message">${PHOTO_MESSAGES[i - 1] || ""}</p>
                    <div class="secret-message">${PHOTO_MESSAGES[i - 1] || ""}</div>
                `;
                polaroid.onclick = () => polaroid.classList.toggle('show');
                fragment.appendChild(polaroid);
            }
            DOM.galleryContainer.appendChild(fragment);
        }

        // Puzzle logic
        function initPuzzle() {
            boardState = Array(ROWS * COLS).fill(null);
            DOM.winPopup.style.display = "none";
            document.documentElement.style.setProperty("--img", `url("${PUZZLE_PHOTOS[photoIndex]}")`);
            
            // Create Board
            DOM.board.innerHTML = "";
            for (let i = 0; i < ROWS * COLS; i++) {
                const cell = document.createElement("div");
                cell.className = "cell";
                cell.dataset.pos = i;
                cell.ondragover = e => e.preventDefault();
                cell.ondrop = e => drop(e, i);
                DOM.board.appendChild(cell);
            }

            // Create Pieces
            DOM.pieces.innerHTML = "";
            const order = [...Array(ROWS * COLS).keys()].sort(() => Math.random() - 0.5);
            order.forEach(i => addPieceToPanel(i));
        }

        function addPieceToPanel(i) {
            const d = document.createElement("div");
            d.className = "piece";
            d.draggable = true;
            d.dataset.i = i;
            const col = i % COLS, row = Math.floor(i / COLS);
            d.style.backgroundPosition = `${(col * 100) / (COLS - 1)}% ${(row * 100) / (ROWS - 1)}%`;
            d.ondragstart = e => { e.dataTransfer.setData("from", "pieces"); e.dataTransfer.setData("i", i); };
            DOM.pieces.appendChild(d);
        }

        function drop(e, pos) {
            const from = e.dataTransfer.getData("from");
            const i = parseInt(e.dataTransfer.getData("i"));
            if (boardState[pos] !== null) addPieceToPanel(boardState[pos]);
            
            const cell = DOM.board.querySelector(`.cell[data-pos="${pos}"]`);
            cell.classList.add("filled");
            const col = i % COLS, row = Math.floor(i / COLS);
            cell.style.backgroundPosition = `${(col * 100) / (COLS - 1)}% ${(row * 100) / (ROWS - 1)}%`;

            if (from === "pieces") {
                const p = DOM.pieces.querySelector(`.piece[data-i="${i}"]`);
                if (p) p.remove();
            }
            boardState[pos] = i;
            if (boardState.every((v, idx) => v === idx)) {
                setTimeout(() => {
                    DOM.winPopup.style.display = "flex";
                    photoIndex = (photoIndex + 1) % PUZZLE_PHOTOS.length;
                }, 300);
            }
        }

        function closePopup() { initPuzzle(); }

        // Initializer
        window.onload = () => {
            goToHome();
            const startInteraction = () => {
                playMusic('home');
                ['click', 'touchstart', 'scroll'].forEach(ev => window.removeEventListener(ev, startInteraction));
            };
            ['click', 'touchstart', 'scroll'].forEach(ev => window.addEventListener(ev, startInteraction));
            
            document.querySelectorAll('.midnight-garden').forEach(garden => initMidnightGardenElement(garden));
        };

        // Garden Engine
        function initMidnightGardenElement(garden) {
            if (!garden || garden.children.length > 0) return;
            const isMobile = window.innerWidth < 600;

            // Stars
            for(let i=0; i < (isMobile ? 100 : 200); i++) {
                const s = document.createElement('div');
                s.className = 'garden-star';
                const size = Math.random() * 2;
                Object.assign(s.style, {
                    width: size + 'px', height: size + 'px',
                    left: Math.random() * 100 + '%', top: Math.random() * 80 + '%'
                });
                s.style.setProperty('--t', (2 + Math.random() * 5) + 's');
                garden.appendChild(s);
            }

            // Grass & Glow
            const glow = document.createElement('div');
            glow.className = 'garden-glow';
            garden.appendChild(glow);

            for(let i=0; i < (isMobile ? 40 : 80); i++) {
                const blade = document.createElement('div');
                blade.className = 'garden-blade';
                const h = 30 + Math.random() * (isMobile ? 80 : 150);
                blade.style.height = h + 'px';
                blade.style.left = Math.random() * 100 + '%';
                blade.style.animation = `swayAnim ${3 + Math.random()*2}s infinite ease-in-out`;
                garden.appendChild(blade);
            }

            // Flowers
            const config = isMobile ? 
                [[15, 150, '#ff1f5a', 6, 0.5], [50, 250, '#00b4d8', 8, 0.2], [85, 180, '#ff9100', 5, 0.8]] :
                [[10, 150, '#ff1f5a', 6, 0.5], [30, 250, '#7b2cb1', 8, 1.4], [50, 350, '#00b4d8', 10, 0.2], [70, 270, '#f72585', 7, 1.9], [90, 200, '#ff9100', 5, 0.8]];
            
            config.forEach(c => createFlower(garden, ...c, isMobile));
        }

        function createFlower(garden, left, height, color, petalCount, delay, isMobile) {
            const system = document.createElement('div');
            system.className = 'garden-flower-system garden-sway';
            system.style.left = left + '%';
            system.style.animationDelay = delay + 's';

            const stem = document.createElement('div');
            stem.className = 'garden-stem';
            const finalHeight = isMobile ? height * 0.7 : height;
            stem.style.setProperty('--h', finalHeight + 'px');
            stem.style.animationDelay = delay + 's';

            const head = document.createElement('div');
            head.className = 'garden-flower-head';
            head.style.animationDelay = (delay + 2.4) + 's';

            for(let i=0; i<petalCount; i++) {
                const p = document.createElement('div');
                p.className = 'garden-petal';
                p.style.setProperty('--pw', (finalHeight/5) + 'px');
                p.style.setProperty('--ph', (finalHeight/3) + 'px');
                p.style.setProperty('--c', color);
                p.style.transform = `rotate(${(360/petalCount) * i}deg)`;
                head.appendChild(p);
            }

            const center = document.createElement('div');
            center.className = 'garden-center';
            head.appendChild(center);
            stem.appendChild(head);
            system.appendChild(stem);
            garden.appendChild(system);
        }
    </script>
</body>
</html>
